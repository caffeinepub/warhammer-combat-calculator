{
  "kind": "coverage_report",
  "version": "1.0",
  "generatedAt": "2026-02-16T06:45:58.607Z",
  "sources": {
    "buildRequest": true,
    "implementationPlan": true
  },
  "requirements": {
    "total": 4,
    "implemented": 4,
    "items": [
      {
        "id": "REQ-18",
        "summary": "Extend the DefenderModel TypeScript data model to support defender-side damage modification that applies after failed saves (including invulnerable saves) and before Feel No Pain. Add two optional fields: (1) a flat per-unsaved-wound damage modifier (e.g., -1) and (2) a boolean to halve damage (minimum 1). Ensure these fields round-trip through scenario serialization/deserialization and are available everywhere DefenderModel is used.",
        "status": "implemented",
        "plannedFiles": [
          "frontend/src/models/combat.ts",
          "frontend/src/utils/scenarioPersistence.ts"
        ],
        "matchedFiles": [
          "frontend/src/models/combat.ts"
        ]
      },
      {
        "id": "REQ-19",
        "summary": "Update the Scenario Builder UI to let users configure defender damage modification. Add controls to `DefenderEditor` to set (a) a flat per-unsaved-wound damage modifier value (allow negative values such as -1) and (b) a toggle for half damage. Use clear English labels and brief helper text indicating this step is applied after saves and before Feel No Pain.",
        "status": "implemented",
        "plannedFiles": [
          "frontend/src/components/scenario/DefenderEditor.tsx"
        ],
        "matchedFiles": [
          "frontend/src/components/scenario/DefenderEditor.tsx"
        ]
      },
      {
        "id": "REQ-20",
        "summary": "Update the deterministic expected-damage engine to apply defender damage modification after the save step and before Feel No Pain. For deterministic calculations, apply the modifier to the weaponâ€™s average damage per unsaved wound in this order: (1) apply flat modifier and clamp to minimum 1, (2) if halve-damage is enabled, halve and clamp to minimum 1, then (3) apply Feel No Pain mitigation. Ensure this affects all deterministic outputs that depend on expected damage (totals, per-defender aggregation, tables, and chance-to-kill).",
        "status": "implemented",
        "plannedFiles": [
          "frontend/src/engine/deterministicExpectedDamage.ts",
          "frontend/src/engine/resolveScenario.ts"
        ],
        "matchedFiles": [
          "frontend/src/engine/deterministicExpectedDamage.ts"
        ]
      },
      {
        "id": "REQ-21",
        "summary": "Update the Monte Carlo simulation engine to apply defender damage modification after saves and before Feel No Pain on a per-unsaved-wound basis. For each unsaved wound: roll weapon damage, apply flat modifier with minimum 1, apply half-damage with minimum 1, then apply Feel No Pain rolls against the resulting damage.",
        "status": "implemented",
        "plannedFiles": [
          "frontend/src/engine/simulation.ts"
        ],
        "matchedFiles": [
          "frontend/src/engine/simulation.ts"
        ]
      }
    ]
  },
  "changedFiles": [
    "build-request.json",
    "feature_evidence.json",
    "frontend-file-summaries.txt",
    "frontend-implementation-plan.json",
    "frontend/src/components/scenario/DefenderEditor.tsx",
    "frontend/src/engine/deterministicExpectedDamage.ts",
    "frontend/src/engine/simulation.ts",
    "frontend/src/models/combat.ts",
    "project_state.json",
    "scratch/component-selection.json",
    "spec.md",
    "spec_vs_diff_report.json"
  ]
}